{"version":3,"sources":["constants/symbols.js","constants/events.js","constants/config.js","store/index.js","utils/event-handler.js","utils/assert.js","utils/stream-handler.js","wiki-events.js"],"names":["_running","Symbol","_paused","_eventHandler","_streamHandler","stream","trackEvents","events","defer","dimensions","since","document","ev","push","type","eventType","x","clientX","y","clientY","assertFunction","v","name","Error","trimLeft","config","WikiEvents","defaultConfig","eventHandler","bind","streamHandler","documentElement","cloneNode","width","window","innerWidth","height","innerHeight","Date","now","start","isStream","store","forEach","addEventListener","removeEventListener","module","exports"],"mappings":"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","file":"wiki-events.js","sourceRoot":"../src","sourcesContent":["export const _running = Symbol();\nexport const _paused = Symbol();\nexport const _eventHandler = Symbol();\nexport const _streamHandler = Symbol();\n","export default [\n  'dblclick',\n  'mousemove',\n  'mousedown',\n  'mouseup',\n  'scroll'\n];\n","import events from './events';\n\nexport default {\n  stream: null,\n  trackEvents: events,\n  defer: false,\n  dimensions: {}\n};\n","export default {\n  events: [],\n  since: null,\n  document: null,\n};\n","import { _paused } from '../constants/symbols';\nimport store from '../store';\n\nexport default function(ev) {\n  if (!this[_paused]) {\n    store.events.push({\n      type: 'event',\n      eventType: ev.type,\n      x: ev.clientX,\n      y: ev.clientY\n    });\n  }\n}\n","export function assertFunction(v, name) {\n  if (typeof v !== 'function') {\n    throw new Error(`${name || ''} must be a function`.trimLeft());\n  }\n}\n","import { assertFunction } from './assert';\nimport { _paused } from '../constants/symbols';\n\nexport default function(ev) {\n  if (!this[_paused]) {\n    assertFunction(this.config.stream);\n\n    this.config.stream({\n      type: 'event',\n      eventType: ev.type,\n      x: ev.clientX,\n      y: ev.clientY\n    });\n  }\n}\n","import { _running, _paused, _eventHandler, _streamHandler } from './constants/symbols';\nimport defaultConfig from './constants/config';\nimport eventHandler from './utils/event-handler';\nimport store from './store';\nimport streamHandler from './utils/stream-handler';\n\nclass WikiEvents {\n  constructor(config = {}) {\n    this.config = { ...defaultConfig, ...config };\n    this[_eventHandler] = eventHandler.bind(this);\n    this[_streamHandler] = streamHandler.bind(this);\n    this[_paused] = false;\n    this[_running] = false;\n\n    store.document = document.documentElement.cloneNode(true);\n    store.dimensions = {\n      width: window.innerWidth,\n      height: window.innerHeight\n    };\n    store.since = Date.now();\n\n    if (!this.config.defer) {\n      this.start();\n    }\n\n    return this;\n  }\n\n  start() {\n    if (!this[_running]) {\n      const isStream = typeof this.config.stream === 'function';\n\n      if (isStream) {\n        this.config.stream({\n          type: 'config',\n          ...store\n        });\n      }\n\n      this.config.trackEvents.forEach(ev => document.addEventListener(\n        ev, isStream ? this[_streamHandler] : this[_eventHandler])\n      );\n\n      return this;\n    }\n  }\n\n  pause() {\n    this[_paused] = true;\n\n    return this;\n  }\n\n  resume() {\n    this[_paused] = false;\n\n    return this;\n  }\n\n  stop() {\n    this.config.trackEvents.forEach(ev => {\n      document.removeEventListener(ev, this[_streamHandler]);\n      document.removeEventListener(ev, this[_eventHandler]);\n    });\n\n    return this;\n  }\n\n  peekEvents() {\n    return store.events;\n  }\n\n  dump() {\n    return store;\n  }\n}\n\nmodule.exports = WikiEvents;\n"]}